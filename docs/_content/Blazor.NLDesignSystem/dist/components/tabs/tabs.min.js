/*!
NL Design System Componenten library 0.1.1, build date 27-06-2020
Copyright 2011-2020 The NL Design System Authors
Copyright 2011-2020 Duo
Author: DUO & The NL Design System Authors
Author URI: https://nl-design-system.gitlab.io/nl-design-system/
License: EUPL v1.2
License URL: https://joinup.ec.europa.eu/software/page/eupl5
Version: 0.1.1
*/
var utils_1=require("./../../core/utils"),RESIZE_THROTTLE=200,Tabs=function(){function o(t){if(this.host=t,this._tabsWidth=0,!t)throw new Error("Host element not supplied");if(this._tabs=t.querySelectorAll(".tab__tab a"),0===this._tabs.length)throw new Error("No tabs found in host element");this.setup()}return Object.defineProperty(o.prototype,"activeTabIndex",{get:function(){for(var t,e=0;e<this._tabs.length;e++)if(this._tabs.item(e).parentElement.classList.contains("tab__tab--active")){t=e;break}return t},enumerable:!0,configurable:!0}),o.deactivatePanes=function(t){for(var e=t.querySelectorAll(".tab__pane"),a=0;a<e.length;a+=1)e.item(a).classList.remove("tab__pane--active")},o.deactivateTabs=function(t){var e=t.querySelectorAll(".tab__tab--active");if(0<e.length)for(var a=0;a<e.length;a++){var i=e.item(a);i.querySelector("a").setAttribute("tabindex","-1"),i.classList.remove("tab__tab--active"),i.setAttribute("aria-selected","false")}},o.getTargetPane=function(t){var e=t.getAttribute("href").substr(1);return document.getElementById(e)},o.prototype.destroy=function(){window.removeEventListener("resize",this),this._tabs=this.host.querySelectorAll(".tab__tab a");for(var t=0;t<this._tabs.length;t++)this._tabs.item(t).removeEventListener("click",this)},o.prototype.disableTab=function(t){if(t===this.activeTabIndex)throw new Error("Cannot disable active tab since it's active");this.toggleEnabled(t,!1)},o.prototype.enableTab=function(t){this.toggleEnabled(t,!0)},o.prototype.handleEvent=function(t){t.currentTarget===window&&"resize"===t.type?this.onScreenResize():t.currentTarget.parentElement.classList.contains("tab__tab")&&this.onTabClick(t)},o.prototype.openTab=function(t){if(!(0<=t&&t<this._tabs.length-1))throw new Error("Tab index "+t+" is out of bounds");this.setActiveTab(this._tabs.item(t))},o.prototype.canBeActivated=function(t){return t.classList.contains("tab__tab--more")?(t.classList.toggle("tab__tab--more-open"),!1):(this._moreTab.classList.remove("tab__tab--more-open"),!t.classList.contains("tab__tab--disabled"))},o.prototype.createClones=function(){for(var t=this._moreTab.querySelector("ul"),e=this.host.querySelectorAll(".tab__tab"),a=0;a<e.length;a++){var i=e.item(a).cloneNode(!0);i.removeAttribute("id"),i.classList.add("tab__tab--clone"),i.classList.add("tab__tab--hidden"),t.appendChild(i)}},o.prototype.createMoreTab=function(){this._moreTab=utils_1.Utils.CreateNode('<li class="tab__tab tab__tab--more">\n                <a href=""><span class="tab__more-link">Meer</span></a>\n                <ul class="tab__more"></ul>\n            </li>'),this.createClones(),this.host.appendChild(this._moreTab)},o.prototype.onScreenResize=function(){clearTimeout(this._resizeTimeout),this._resizeTimeout=window.setTimeout(this.rearrange.bind(this),RESIZE_THROTTLE)},o.prototype.onTabClick=function(t){t.preventDefault(),this.setActiveTab(t.currentTarget)},o.prototype.keyboardSwitchTabs=function(t){if("ArrowLeft"===t.key){var e=this.getPreviousTab();e&&this.setActiveTab(e)}else if("ArrowRight"===t.key){var a=this.getNextTab();a&&this.setActiveTab(a)}},o.prototype.rearrange=function(){var t=parseInt(getComputedStyle(this.host).width),e=this._tabsWidth,a=this.host.querySelectorAll(".tab__tab:not(.tab__tab--clone)"),i=this.host.querySelectorAll(".tab__tab--clone"),s=a.length-1;for(a.item(0).style.maxWidth="";0<--s;)a.item(s).classList.remove("tab__tab--hidden"),i.item(s).classList.add("tab__tab--hidden");for(s=a.length-1;t<e&&0<--s;){var r=a.item(s),o=i.item(s);r.classList.add("tab__tab--hidden"),o.classList.remove("tab__tab--hidden"),e-=parseInt(r.getAttribute("data-width"))}if(0===s){var n=t-parseInt(this._moreTab.getAttribute("data-width"));a.item(0).style.maxWidth=n+"px"}null===this.host.querySelector(".tab__tab--clone:not(.tab__tab--hidden)")?this._moreTab.classList.add("tab__tab--hidden"):this._moreTab.classList.remove("tab__tab--hidden")},o.prototype.setup=function(){window.addEventListener("resize",this),this.createMoreTab(),this.storeWidths(),this._tabs=this.host.querySelectorAll(".tab__tab a");for(var t=this.host.querySelectorAll(".tab__tab--disabled"),e=0;e<t.length;e++)t.item(e).setAttribute("disabled","");var a=this.host.querySelector(".tab__tab--active a");for(e=0;e<this._tabs.length;e++)this._tabs.item(e).addEventListener("click",this),this._tabs.item(e).addEventListener("keyup",this.keyboardSwitchTabs.bind(this)),this._tabs.item(e).setAttribute("tabindex","-1");this.setActiveTab(a||this._tabs.item(0)),this.rearrange()},o.prototype.getTabElement=function(t,e,a){return(t[a].classList.contains("tab__tab--hidden")?e[a]:t[a]).firstChild},o.prototype.getNextTab=function(){for(var t=this.host.querySelectorAll(".tab__tab:not(.tab__tab--clone):not(.tab__tab--more)"),e=this.host.querySelectorAll(".tab__tab--clone"),a=this.activeTabIndex+1,i=a<t.length?a:0;i<t.length;i+=1)if(this.canBeActivated(utils_1.Utils.FindParentContainingClass(t.item(i),"tab__tab",this.host)))return this.getTabElement(t,e,i);return null},o.prototype.getPreviousTab=function(){for(var t=this.host.querySelectorAll(".tab__tab:not(.tab__tab--clone )"),e=this.host.querySelectorAll(".tab__tab--clone"),a=this.activeTabIndex-1,i=0<=a?a:t.length-1;0<=i;i-=1)if(this.canBeActivated(utils_1.Utils.FindParentContainingClass(t.item(i),"tab__tab",this.host)))return this.getTabElement(t,e,i);return null},o.prototype.setActiveTab=function(t){var e=o.getTargetPane(t),a=utils_1.Utils.FindParentContainingClass(t,"tab__tab",this.host);if(this.canBeActivated(a)){o.deactivateTabs(this.host),o.deactivatePanes(utils_1.Utils.FindParentContainingClass(e.parentElement,"tab__content",this.host));for(var i=t.getAttribute("href"),s=this.host.querySelectorAll('a[href="'+i+'"]'),r=0;r<s.length;r++)a=utils_1.Utils.FindParentContainingClass(s.item(r),"tab__tab",this.host),s.item(r).removeAttribute("tabindex"),a.classList.add("tab__tab--active"),a.setAttribute("aria-selected","true"),a.parentElement.classList.contains("tab__more")&&!a.classList.contains("tab__tab--hidden")&&this._moreTab.classList.add("tab__tab--more-open");t.focus(),e.classList.add("tab__pane--active")}},o.prototype.storeWidths=function(){this.host.classList.add("tab--setup");for(var t=this.host.querySelectorAll(".tab__tab:not(.tab__tab--clone)"),e=0;e<t.length;e++){var a=t.item(e),i=Math.ceil(parseFloat(getComputedStyle(a).width));i+=Math.ceil(parseFloat(getComputedStyle(a).marginLeft)),i+=Math.ceil(parseFloat(getComputedStyle(a).marginRight)),this._tabsWidth+=i,a.setAttribute("data-width",i.toString())}this.host.classList.remove("tab--setup")},o.prototype.toggleEnabled=function(t,e){if(!(0<=t&&t<this._tabs.length-1))throw new Error("Tab index "+t+" is out of bounds");var a=this.host.querySelectorAll(".tab__tab:not(.tab__tab--clone)"),i=this.host.querySelectorAll(".tab__tab--clone"),s=e?"remove":"add";e?(a.item(t).removeAttribute("disabled"),i.item(t).removeAttribute("disabled")):(a.item(t).setAttribute("disabled",""),i.item(t).setAttribute("disabled","")),a.item(t).classList[s]("tab__tab--disabled"),a.item(t).querySelector("a").setAttribute("tabindex",e?(0).toString():(-1).toString()),i.item(t).classList[s]("tab__tab--disabled"),i.item(t).querySelector("a").setAttribute("tabindex",e?(0).toString():(-1).toString())},o}();exports.Tabs=Tabs;